# Higher order Component

## 05-1 커링과 조합 개념 공부하기

커링 : 반환값이 함수인 디자인 패턴을 말하며 중복된 코드를 반복적으로 입력하지 않고 원하는 기능을 조합하여 적재적소에 사용할 수 있다는 장점이 있다.

**커링 개념 알아보기**

커링은 ‘함수를 반환하는 함수’ 라고 생각하면 된다. 커링을 사용해야 하는 이유는 ‘함수의 재사용’ 때문이다. 인자를 나중에 받아 실행할 함수를 생성해주는 함수를 커링 함수라고 부른다.

```tsx
function multiply(x){
		return function(a){
			return multiply(a, x);
		}
}
...

const multiplyX = x => a => multiply(a, x); 
const result1 = multiply(3)(3) // 9
```

이를 통해 withStyples(..)(..) 와 같이 2개의 소괄호를 붙여 사용한 패턴에 익숙해지길 바란다.

<aside>
💡 multiply(a, b) 와 같은 방법으로 함수를 만들어도 같은 결과 값을 얻을 수 있지 않을까 싶겠지만, 이는 ‘인자를 한꺼번에 전달해야’ 하므로 multiply(3) 을 실행한 다음 다른 작업을 할 수 없다. → 함수의 재활용이 어렵다. 커링 함수의 특징은 ‘인자를 나눠 받아 실행할 수 있다’ 는 점이다.

</aside>

**커링 응용하기**

커링 개념은 이후 하이어오더 컴포넌트에 사용되므로 매우 중요하다. 커링은 여러겹 겹쳐서 재사용할 수도 있고, 이 패턴은 추후 하이어오더 컴포넌트에 자주 등장한다.

즉, 커링이란 ‘함수의 인자를 다시 구성해 필요한 함수를 만드는 패턴’ 이다. 인자의 순서, 개수에 따라 비슷한 함수를 반복해 작성해야 하는 부분을 커링을 이용하면 커링 패턴으로 묶인 함수들을 쉽게 유지, 보수 할 수 있어 유용하다.

**커링을 이용해 함수를 조합하는 기법 알아보기**

함수의 적용 순서는 오른쪽에서 왼쪽 방향이므로 사람이 함수의 적용 흐름을 한 번이 이해하기 힘들다는 단점이 있다. 코드 가독성이 떨어져 수식을 읽는 순서대로 함수를 조합해 잘못된 결과를 가ㅈ져올 수도 있다.

- compose() 함수 만들어보기

## 05-2 하이어오더 컴포넌트 기초 개념 공부하기

디자인 패턴은 작성한 코드의 구조를 더 견고히 하고, 손쉽게 재활용할 수 있게 해준다. 앞에서 공부한 커링도 디자인 패턴의 일종이다. 리액트 컴포넌트에서도 디자인 패턴을 적용할 수 있다.

이번에 알아볼 디자인 패턴은 데코레이터 패턴이며, 이후 데코레이터 패턴을 적용해 하이어오더 컴포넌트까지 개념을 확장할 생각.

**상속 패턴보다 데코레이터 패턴이 필요한 이유**

데코레이터 패턴을 이해하려면 먼저 상속 패턴과 이의 단점을 알아야 한다.

상속 패턴은 ‘공통 기능은 부모로부터 물려받고, 추가 기능만 구현해 중복 코드의 양을 줄일 수 있다.’ 라는 장점이 있지만, 부모의 속성을 동시에 가질 경우 많은 문제가 발생한다.

- 상속 패턴의 단점 살펴보기

버튼의 기본 기능을 가진 Button 클래스가 있다 가정할 때, Button 클래스를 확장하여 LoadingButton 클래스 (로딩 중임을 나타내는 버튼)과 TooltipButton 클래스 (추가 설명을 보여주는 버튼)을 만들었다 가정하자. 이 클래스들의 관계는 다음과 같다.


<p style="text-align: center">
<img width="400" src="https://github.com/al1kite/dev-books-i-ever-read/assets/102217402/71448bf0-ed72-4838-a205-b1354eba001f">
</p>

그런데 전송 버튼도 필요할 것 같아 기본 클래스인 Button 클래스를 상속해 SubmitBotton 을 제작한 후, 전송 버튼에 로딩 상태를 표시하는 기능까지 넣으면 다음과 같은 상속 구조가 된다.

<p style="text-align: center">
<img width="400" src="https://github.com/al1kite/dev-books-i-ever-read/assets/102217402/38f87a4d-2a04-45f1-a5c2-2a7878aa1236">
</p>

여기에서 로딩 상태를 표시하는 기능과 추가 설명을 표시하는 기능을 추가하면 위의 상속 패턴을 그대로 사용할 수 없어 다음과 같이 상속 구조가 변경된다.

<p style="text-align: center">
<img width="150" src="https://github.com/al1kite/dev-books-i-ever-read/assets/102217402/1ec0fec9-6d00-4726-b4ae-16bd18a04cfe">
</p>

제대로 해결된 것 같지만, 이 상속 구조에는 다음과 같은 문제점이 있다.

```tsx
1. 추가 설명 표시 버튼이 강제로 로딩 버튼의 기능을 물려 받았다. (원치 않은 상속)
2. 추가 설명 표시 버튼을 상속한 버튼들이 있다면 이 버튼들의 상속 구조 역시 변경된다.
3. 상속 구조가 깊기 때문에 상속 항목을 한눈에 파악하기 어렵다.
```

기존 구조를 해치지 않으면서 원하는 기능만 상속받기 위해 제안된 디자인 패턴이 ‘데코레이터 패턴’ 이다.

**데코레이터 패턴 알아보기**

데코레이터 패턴은 클래스 간의 종속성 없이 기능만을 공유한다.

<p style="text-align: center">
<img width="600" src="https://github.com/al1kite/dev-books-i-ever-read/assets/102217402/87d63c60-88fd-4f4b-be9c-7e59cde2d274">
</p>



다음 그림을 보면 위의 예제에서는 상속 구조에 따라 기능을 순서대로 물려받았지만 데코레이터 패턴에서는 필요한 기능만 탑재하여 각각 독립된 객체를 생성한 것을 볼 수 있다. 또한 상속 구조와 상관 없이 상위 클래스인 Button 역시 각 기능을 따로 탑재해 생성 가능하다. 상속 패턴에선 버튼 속에 기능이 있었지만, 이젠 분리된 것을 확인 할 수 있다.

→ 이것을 바로 ‘독립된 데코레이터로 기능을 구성했다’ 라고 한다. 자바 언어에서는 이러한 데코레이터 패턴을 구현하기 위해 인터페이스를 사용하며, 자바스크립트에서는 커링을 사용한다.

이제부터 커링을 이용해 데코레이터 패턴을 적용한 하이어오더 컴포넌트에 대해 알아볼 예정.

**하이어오더 컴포넌트의 개념 알아보기**

하이어오더 컴포넌트라는 이름은 자바스크립트의 고차 함수에서 유래됨.

- 하이어오더 컴포넌트는 함수나 클래스 형태의 컴포넌트 모두 반환 가능

하이어오더 컴포넌트는 기존 컴포넌트에 기능을 입혀 새 컴포넌트로 반환하는 함수 의미.

보통 하이어오더 컴포넌트가 반환하는 컴포넌트를 확장 컴포넌트라 명명. 확장 컴포넌트의 형태는 개발자가 직접 결정하면 되지만, 보통 ‘생명주기 함수를 확장한 하이어오더 컴포넌트를 구성해야 하는 경우’ 클래스형 컴포넌트를 반환하도록 구현

- 하이어오더 컴포넌트는 기존 컴포넌트에 연결된 프로퍼티를 모두 전달해주어야 한다.

하이어오더 컴포넌트는 기존 컴포넌트를 확장한 컴포넌트이므로 기존 컴포넌트로 모든 프로퍼티를 전달해주어야 한다.

- 하이어오더 컴포넌트와 확장 컴포넌트의 이름은 with 로 시작

암묵적으로 하이어오더 컴포넌트와 확장 컴포넌트 이름에 with 를 붙인다.

## 05-3 하이어오더 컴포넌트 라이브러리 사용하기

recompose 라이브러리는 하이어오더 컴포넌트 중 자주 사용하는 패턴을 모은 ‘하이어오더 컴포넌트 라이브러리’지만 리액트 16.8 부터는 대부분의 recompose 기능이 리액트 훅에 구현되어 있다.

다만 recompose 의 활용 방법을 알면 함수형 컴포넌트의 기능 확장하는 방법을 숙지하는데 도움이 된다

## 05-4 다중 하이어오더 컴포넌트 사용하기

하이어오더 컴포넌트는 구조 상 다른 하이어오더 컴포넌트를 조합해 사용할 수 있다. 이 방법을 사용하면 코드를 효율적으로 작성해 사용할 수 있으므로 반복된 코드를 잘게 분리 후 공유해 코드의 양을 획기적으로 줄일 수 있다.

**다중 하이어오더 컴포넌트 개념 알아보기**

하이어오더 컴포넌트는 기존 컴포넌트에 기능을 추가해 새로운 컴포넌트를 반환하는 구조이므로 하이어오더 컴포넌트를 겹치면 계속해서 컴포넌트의 기능을 확장할 수 있다.

이러한 호출 방식은 커링 함수에서 배운 조합 개념으로 하이어오더 컴포넌트를 쉽게 조합할 수 있다.